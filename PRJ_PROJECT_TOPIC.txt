PROJECT PRJ301: FPT_FOOD (FINAL VERSION)
1. TỔNG QUAN HỆ THỐNG
Mục tiêu: Xây dựng hệ thống quản lý nhà hàng với quy trình khép kín: 
Khách đặt món -> Bếp nấu & Trừ kho -> Quản lý thanh toán & Nhập kho.
Tổng số bảng Database: 10 Bảng.

2. PHÂN CÔNG CHI TIẾT (ROLE & RESPONSIBILITY)

KHẢI – VAI TRÒ: USER (KHÁCH HÀNG)
Giao diện phụ trách: Home.jsp, Login.jsp
Các bảng phụ trách (6): User, DiningTable, Orders, OrderItem, Voucher, Review.

Chức năng CRUD chi tiết:
User:
Create: Đăng ký tài khoản mới.
Read: Đăng nhập hệ thống.
Update: Cập nhật thông tin cá nhân (Profile).
Delete: Đăng xuất (Hủy session).

DiningTable:
Read: Xem danh sách bàn & trạng thái (Trống/Đang dùng).
Logic: Chọn bàn -> Backend tự động chuyển trạng thái empty -> busy.
Orders & OrderItem (Giỏ hàng):
Create: Thêm món vào giỏ, tạo đơn hàng (Orders status = 'pending').
Read: Xem lịch sử đơn hàng, xem chi tiết món trong giỏ.
Update: Chỉnh sửa số lượng món trong giỏ.
Delete: Xóa món khỏi giỏ, Hủy đơn hàng (chỉ khi Bếp chưa nhận đơn).

Voucher:
Read: Kiểm tra mã giảm giá hợp lệ.
Logic: Nhập code tại giỏ hàng -> Backend check DB -> Giảm totalPrice.

Review:
Create: Viết đánh giá cho món ăn (Chỉ User đã đăng nhập).
Read: Xem đánh giá của người khác tại Popup chi tiết món ăn.

THẮNG – VAI TRÒ: MANAGER (QUẢN TRỊ VIÊN)
Giao diện phụ trách: Dashboard.jsp
Các bảng phụ trách (6): User (Staff), DiningTable, Orders, Food, Ingredient, Category (Mới).

Chức năng CRUD chi tiết:

DiningTable & Orders (Quy trình thanh toán):
Read: Xem sơ đồ bàn, xem chi tiết hóa đơn của từng bàn.
Update (Thanh toán): Bấm "Thanh toán" -> Set Orders status = 'Paid' -> Tự động chuyển DiningTable về 'Empty'.
Delete: Hủy các đơn hàng bị lỗi hoặc khách bỏ về.

Food & Category (Quản lý Menu):
Create: Thêm món mới, Thêm danh mục mới (Category).
Read: Xem danh sách món ăn.
Update: Sửa giá món, Sửa tên danh mục.
Delete: Ẩn món ăn (Soft delete) hoặc xóa danh mục.

Ingredient (Quản lý Kho):
Read: Xem danh sách nguyên liệu, Cảnh báo màu đỏ nếu quantity < minThreshold.
Update (Nhập kho): Nhập thêm hàng -> Tăng quantityInStock.

ÂN – VAI TRÒ: KITCHEN (NHÂN VIÊN BẾP)
Giao diện phụ trách: Kitchen.jsp
Các bảng phụ trách (5): Orders, OrderItem, Food, Ingredient, Recipe.

Chức năng CRUD chi tiết:

Orders (Quy trình nấu):
Read: Xem danh sách các đơn hàng mới (pending).
Update: Chuyển trạng thái: pending (Nhận đơn) -> cooking (Đang nấu) -> done (Xong món).

Recipe (Quản lý Công thức - CRUD chính của Bếp):
Create: Định nghĩa công thức mới (VD: 1 Pizza = 200g Bột + 100g Phô mai).
Read: Xem công thức của từng món.
Update: Điều chỉnh định lượng nguyên liệu (VD: Giảm đường, tăng muối).
Delete: Xóa một nguyên liệu khỏi công thức.

Food:
Update: Đánh dấu "Hết món" (Unavailable) nếu kho hết nguyên liệu (Hiển thị ngay lập tức lên trang Home của Khách).

3. LUỒNG DỮ LIỆU (DATA FLOW)
Dưới đây là mô tả cách dữ liệu di chuyển giữa 3 vai trò để đảm bảo logic 

Luồng 1: Quy trình Đặt món & Nấu ăn (Core Flow)

Khách (Khải): Vào Home.jsp -> Chọn Bàn -> Chọn Món -> Bấm "Đặt món".
DB Update: Tạo Orders (status='pending'), tạo OrderItem. DiningTable chuyển sang 'Busy'.
Bếp (Ân): Tại Kitchen.jsp thấy đơn mới -> Bấm "Nấu".
DB Update: Orders chuyển sang 'cooking'.
Logic Kho: Hệ thống tự động trừ Ingredient (Số lượng tồn kho) dựa trên Recipe của các món trong đơn.
Bếp (Ân): Nấu xong -> Bấm "Hoàn thành".
DB Update: Orders chuyển sang 'done'.

Luồng 2: Quy trình Thanh toán & Trả bàn

Khách (Khải): Ăn xong, gọi thanh toán.
Manager (Thắng): Tại Dashboard.jsp -> Chọn bàn -> Xem hóa đơn -> Bấm "Thanh toán".
DB Update:
Orders set status = 'Paid'.
DiningTable set status = 'Empty' (Bàn trống để khách khác vào).

Luồng 3: Quy trình Quản lý Kho & Công thức

Manager (Thắng): Mua nguyên liệu về -> Vào Dashboard -> Cập nhật số lượng Ingredient (Nhập kho).
Bếp (Ân): Vào Kitchen -> Tạo/Sửa Recipe để hệ thống biết 1 món ăn tiêu tốn bao nhiêu nguyên liệu.
Hệ thống: Khi có đơn hàng (Luồng 1), hệ thống sẽ lấy Recipe nhân với số lượng món khách đặt để trừ vào Ingredient.